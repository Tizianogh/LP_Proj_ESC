<div class="container-fluid">

    <div class="row my-3 justify-content-center">
        <div class="col-11 px-0 text-center">
            <div class="card px-0" id="card">
                <ul id="progressbar">
                    <li class="active" id="votes">{{'objection.Votes' | translate}}</li>
                    <li class="active" id="repportVotes">{{'objection.ReportDeVotes' | translate}}</li>
                    <li class="active title" id="objections">{{'objection.Objections' | translate}}</li>
                    <li id="bonification">{{'objection.Bonificaition' | translate}}</li>
                    <li id="celebration">{{'objection.Celebration' | translate}}</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <p class="intro text-center">
                    {{'objection.introPoste' | translate}} {{ this.election['job'] }}, {{'objection.candidatActuel'| translate}} :
                </p>
            </div>
        </div>

        <div class="row mt-5">
            <div class="col-md-12">
                <div class="profile-userpic text-center">
                    <img class="img-responsive" id="proposedIcon" src="data:image/png;base64,{{actualProposed['avatar']}}" height="120" />
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
                <div class="profile-usertitle-name text-center">
                    {{actualProposed['firstName']}} {{actualProposed['lastName']}}
                </div>
            </div>
        </div>

        <div *ngIf="connectedParticipant['hasTalked']; then cantVote else canVote"></div>
        <ng-template #canVote>
            <div class="row mt-3 justify-content-center">
                <div class="col-md-10 text-center">
                    <textarea class="form-control d-flex justify-content-center" id="argumentaires" [(ngModel)]="textEntered" placeholder="{{'objection.argObjection' | translate}}" rows="4"></textarea>
                </div>
            </div>
            <div class="row my-3 justify-content-center">
                <div class="col-md-5 mb-3 mb-md-0 text-center text-md-left">
                    <button type="submit" class="btn send" [disabled]="!textEntered"  (click)="objection()">{{'objection.objecter' | translate}}</button>
                </div>
                <div class="col-md-5 text-center text-md-right">
                    <button type="submit" class="btn send" (click)="endObjection()">{{'objection.pasDObjections' | translate}}</button>
                </div>
            </div>
        </ng-template>
        <ng-template #cantVote>
            <div class="col text-center attente">
                {{'objection.attPart' | translate}}
            </div>
        </ng-template>

        <div class="row mt-5 justify-content-center">
            <div class="col-md-10 text-center">

                <div class="col-md-10 text-md-left">
                    <label id="participantsTalk" style="text-align:left;"> {{participantsTalk}} participants sur {{participantsList.length}} ont indiqué avoir fini d'objecter.</label>
                </div>

                <div *ngIf="election['hostId'] == connectedAccount.userId; then thenBlockA else elseBlockA"></div>

                <ng-template #thenBlockA>
                    <table class="table table-hover table-md">
                        <thead class="thead-dark">
                            <tr>
                                <th scope="col">{{'objection.auteur' | translate}}</th>
                                <th scope="col">{{'objection.opinion' | translate}}</th>
                                <th scope="col">{{'objection.action' | translate}}</th>

                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let objection of objectionsList" id="objection_{{objection['opinionId']}}">
                                <td id="opinion{{objection['opinionId']}}"></td>
                                <td>{{objection['reason']}}</td>
                                <td>
                                    <!--On a seulement besoin du buton refuser car si il ne la refuse pas, c'est qu'il l'accepte
                                    (et puis comme ça on a juste a supprimer l'objection de la bdd)-->

                                    <button type="submit" class="btn send" (click)="validateObjection()">{{'objection.validObjection' | translate}}</button>

                                </td>
                            </tr>
                        </tbody>
                    </table>
                </ng-template>

                <ng-template #elseBlockA>
                    <table class="table table-hover table-md">
                        <thead class="thead-dark">
                            <tr>
                                <th scope="col">Auteur</th>
                                <th scope="col">Opinion</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let objection of objectionsList" id="objection_{{objection['opinionId']}}">
                                <td id="opinion{{objection['opinionId']}}"></td>
                                <td>{{objection['reason']}}</td>
                            </tr>
                        </tbody>
                    </table>
                </ng-template>
            </div>
        </div>

        <div class="row my-5">
            <div class="col-md-12 text-center">
                <div *ngIf="election['hostId'] == connectedAccount.userId; then thenBlockV else ElseBlockV"></div>
                <ng-template #thenBlockV>
                    <button type="submit" class="btn accept" (click)="acceptCandidate()">{{'objection.acceptCand' | translate}}</button>
                </ng-template>
                <ng-template #ElseBlockV>
                    <button class="btn send" (click)="becomeHost()">{{'objection.recupDroits' | translate}}</button>
                </ng-template>
            </div>
        </div>
    </div>
</div>