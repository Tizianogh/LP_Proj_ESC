#pragma checksum "D:\Cours\ProjetLicense\LP_Proj_ESC\CreationCompte\CreationCompte\Pages\Index.razor" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "dfcffae1304c8fa7f009e1c5f9aa145295b3d000"
// <auto-generated/>
#pragma warning disable 1591
#pragma warning disable 0414
#pragma warning disable 0649
#pragma warning disable 0169

namespace CreationCompte.Pages
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Components;
#nullable restore
#line 2 "D:\Cours\ProjetLicense\LP_Proj_ESC\CreationCompte\CreationCompte\_Imports.razor"
using Microsoft.AspNetCore.Components.Forms;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "D:\Cours\ProjetLicense\LP_Proj_ESC\CreationCompte\CreationCompte\_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "D:\Cours\ProjetLicense\LP_Proj_ESC\CreationCompte\CreationCompte\_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "D:\Cours\ProjetLicense\LP_Proj_ESC\CreationCompte\CreationCompte\_Imports.razor"
using Microsoft.JSInterop;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "D:\Cours\ProjetLicense\LP_Proj_ESC\CreationCompte\CreationCompte\_Imports.razor"
using CreationCompte;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "D:\Cours\ProjetLicense\LP_Proj_ESC\CreationCompte\CreationCompte\_Imports.razor"
using CreationCompte.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "D:\Cours\ProjetLicense\LP_Proj_ESC\CreationCompte\CreationCompte\_Imports.razor"
using Microsoft.AspNetCore.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "D:\Cours\ProjetLicense\LP_Proj_ESC\CreationCompte\CreationCompte\_Imports.razor"
using System.Text.RegularExpressions;

#line default
#line hidden
#nullable disable
#nullable restore
#line 10 "D:\Cours\ProjetLicense\LP_Proj_ESC\CreationCompte\CreationCompte\_Imports.razor"
using Newtonsoft.Json;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "D:\Cours\ProjetLicense\LP_Proj_ESC\CreationCompte\CreationCompte\Pages\Index.razor"
using System.Net.Http;

#line default
#line hidden
#nullable disable
    [Microsoft.AspNetCore.Components.RouteAttribute("/")]
    public partial class Index : Microsoft.AspNetCore.Components.ComponentBase
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
        }
        #pragma warning restore 1998
#nullable restore
#line 95 "D:\Cours\ProjetLicense\LP_Proj_ESC\CreationCompte\CreationCompte\Pages\Index.razor"
      

    private string mail = "";
    private string pass = "";
    private string passConfirm = "";
    private string nom = "";
    private string prenom = "";
    private string poste = "";
    private DateTime dateNaiss = new DateTime();
    private string desc = "";
    private string sortie = "";
    private IList<String> warns = new List<String>();


    public void traiterDemande()
    {
        warns.Clear();
        verifNull();
        verifMail();
        verifPass();

        if (warns.Count == 0)
        {

            //string output = "0," + mail + ","+ pass + "," + "d," + dateNaiss + "," + desc + "," + prenom + "," + nom;

            var user = new{
                UserId = 0,
                Email = mail,
                Password = pass,
                Salt = "d",
                BirthDate = dateNaiss,
                Description = desc,
                FirstName = prenom,
                LastName = nom
            };

            string output = JsonConvert.SerializeObject(user);
            //var output = new StringContent(user.ToString());
            warns.Add(output.ToString());
            createUser(output);
        }

    }

    private async Task createUser(string jsonUser)
    {
       
        await Http.PostJsonAsync("https://localhost:44329/api/Users", jsonUser);
    }


    public void verifNull()
    {
        if (desc.Trim().Equals("") ||
            mail.Trim().Equals("") ||
            pass.Trim().Equals("") ||
            passConfirm.Trim().Equals("") ||
            nom.Trim().Equals("") ||
            prenom.Trim().Equals("") ||
            dateNaiss.ToString().Trim().Equals(""))
        {
            warns.Add("Tous les champs sont obligatoires");
        }
    }

    public void verifMail()
    {
        Regex regex = new Regex(@"^([\w\.\-]+)@([\w\-]+)((\.(\w){2,3})+)$");
        Match match = regex.Match(mail);
        if (!match.Success || match == null)
        {
            warns.Add("Le mail " + mail + " est incorrect");
        }
    }

    public void verifPass()
    {
        if (pass.Trim().Length < 5 || pass == null)
        {
            warns.Add("Mot de passe trop court de " + (5 - pass.Trim().Length));
        }
    }

#line default
#line hidden
#nullable disable
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private HttpClient Http { get; set; }
    }
}
#pragma warning restore 1591
